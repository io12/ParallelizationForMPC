def histogram(A!0: shared[list[int]], B!0: shared[list[int]], N!0: plaintext[int], num_bins!0: plaintext[int]) -> shared[list[int]]:
    result!1 = []
    for i!1 in range(0, num_bins!0):
        result!2 = Φ(result!1, result!3)
        !1!2 = [0]
        result!3 = (result!2 + !1!2)
    for i!2 in range(0, num_bins!0):
        result!4 = Φ(result!2, result!5)
        for j!1 in range(0, N!0):
            result!5 = Φ(result!4, result!7)
            !2!3 = (A!0[j!1] == i!2)
            !3!3 = (result!5[i!2] + B!0[j!1])
            result!6 = Update(result!5, i!2, !3!3)
            result!7 = MUX(!2!3, result!6, result!5)
    return result!4
